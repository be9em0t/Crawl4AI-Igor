# unity_shadergraph.yaml
# Config for crawling Unity ShaderGraph Node Library

name: "unity_shadergraph"
type: "llm"
provider: "openai/gpt-4.1"
url: "https://docs.unity3d.com/Packages/com.unity.shadergraph@17.4/manual/Node-Library.html"
output_prefix: "unity_shadergraph"
structure_instruction: |
  Return a strict JSON array that represents the Shader Graph Node Library #graph-nodes table anchor structure. 
  Limit only to "Graph nodes", skip "Block nodes".
  The top-level value MUST be a JSON array of topic objects. Each topic object must have:
    - "topic": string
    - "categories": an array of category objects

  Each category object must have:
    - "category": string
    - "nodes": an array of node name strings

  Rules:
  - If a topic has zero categories, represent it as a single category with the topic name.
    Example: {"topic": "Channel", "categories": [{"category": "Channel", "nodes": ["Combine Channels", "Split Channels"]}]}
  - Do NOT include any descriptions, explanations, or extra text outside the JSON array.
  - Only return valid JSON (no Markdown, no commentary). Example top-level shape:

  [
    {
      "topic": "Artistic",
      "categories": [
        {"category": "Adjustment", "nodes": ["Channel Mixer", "Contrast"]},
        {"category": "Blend", "nodes": ["Blend Node A", "Blend Node B"]}
      ]
    },
    {
      "topic": "Channel",
      "categories": [{"category": "Channel", "nodes": ["Combine Channels", "Split Channels"]}]
    }
  ]

  Make the JSON precise: include all topics, categories and node names found on the page in the structure above.
  End of instruction.
content_instruction: |
  Extend the structure extraction with the descriptions provided for each node.
  Each node may be returned either as a string (node name) or as an object with two fields:
    - name: string (the node name)
    - description: string (the description scraped from the same locatoin as the node name)
  If a description is not available with the node name in #graph-nodes table anchor, crawl to the URL of the node name and fetch description there. If still unavailable log to command line as error.
# Instruction for the LLM to discover DOM selectors that reliably locate node names and descriptions
dom_discovery_instruction: |
  Inspect the provided Shader Graph index page and the individual node pages. Return a JSON object with two fields:
    - index_selectors: a list of CSS selectors (or anchor/text heuristics) that identify node links/names on the index page.
    - node_page_selectors: a list of CSS selectors (or XPath) that locate the description paragraph or block on a node page (prefer the paragraph immediately following the main H1/H2 header).
  The response must be a strict JSON object. Only return JSON.
params:
  temperature: 0.0
  max_tokens: 3000
